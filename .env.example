# =============================================================================
# Environment Configuration - Development
# =============================================================================
# This is a template for local development with mock authentication.
# Copy this file to .env and adjust values as needed.
#
# PLACEHOLDER PATTERN: Values wrapped in {{VARIABLE_NAME}} are placeholders.
# Replace them with your actual values (remove the {{ }} brackets).
#
# For production deployments, use:
# - .env.external.example for SAML 2.0 (Alberta.ca Account)
#
# Validate configuration: npm run validate-env
# =============================================================================

# -----------------------------------------------------------------------------
# Application
# -----------------------------------------------------------------------------
NODE_ENV=development
PORT=3000
HOST=localhost
APP_NAME=Alberta Government Public Application Template

# -----------------------------------------------------------------------------
# Session Management
# -----------------------------------------------------------------------------
# For production, generate a secure random string:
# openssl rand -base64 32
SESSION_SECRET=dev-secret-change-in-production-minimum-32-characters
SESSION_STORE=memory
SESSION_MAX_AGE=28800000                 # 8 hours (Protected B); rolling resets on activity
SESSION_COOKIE_SAME_SITE=lax
# SESSION_COOKIE_SECURE will be auto-set based on NODE_ENV

# Redis (Session Store) — uncomment for production or testing with Redis
# SESSION_STORE=redis
# REDIS_URL=redis://localhost:6379
#
# Redis auth mode: accesskey (default, uses REDIS_URL) or entraid (Entra ID token)
# REDIS_AUTH_MODE=accesskey
#
# Entra ID Redis auth (UAT/PROD) — passwordless via @azure/identity:
# REDIS_AUTH_MODE=entraid
# REDIS_HOST=myredis.redis.cache.windows.net
# REDIS_PORT=6380
# REDIS_USERNAME=<managed-identity-object-id>
# Azure credentials are auto-discovered by DefaultAzureCredential:
#   Managed identity (automatic on Azure), or set AZURE_CLIENT_ID +
#   AZURE_TENANT_ID + AZURE_CLIENT_SECRET for service principal

# -----------------------------------------------------------------------------
# Authentication - Mock Driver (Development)
# -----------------------------------------------------------------------------
AUTH_DRIVER=mock

# Auth callback URL - Optional in most cases
# The callback URL is auto-detected in this priority:
# 1. AUTH_CALLBACK_URL (if explicitly set)
# 2. API_URL + /api/v1/auth/callback
# 3. RENDER_EXTERNAL_URL (auto-set by Render.com)
# 4. HOST:PORT derivation (for local development)
#
# Only set this if auto-detection doesn't work for your deployment:
# AUTH_CALLBACK_URL=http://localhost:3000/api/v1/auth/callback
#
# Alternatively, set API_URL for your deployment:
# API_URL=https://your-api.example.com

# For SAML (Alberta.ca Account), see:
# - .env.external.example

# -----------------------------------------------------------------------------
# Frontend
# -----------------------------------------------------------------------------
WEB_URL=http://localhost:5173
CORS_ORIGIN=http://localhost:5173
CORS_CREDENTIALS=true

# -----------------------------------------------------------------------------
# Security
# -----------------------------------------------------------------------------
# Rate limiting - max requests per 15 minutes per IP
RATE_LIMIT_MAX=10000
AUTH_RATE_LIMIT_MAX=100

# Host header validation (REQ-P1-01) — comma-separated allowed hostnames
# Required in production to prevent host header injection
# ALLOWED_HOSTS=your-app.alberta.ca

# Content Security Policy
# HELMET_CSP=false

# -----------------------------------------------------------------------------
# API Gateway (BFF Proxy to Private Backend)
# -----------------------------------------------------------------------------
# Uncomment and configure for proxying requests to the private-facing app
# PRIVATE_API_BASE_URL=http://localhost:3001/api/v1
# OAUTH_TENANT_ID=
# OAUTH_CLIENT_ID=
# OAUTH_CLIENT_SECRET=
# OAUTH_SCOPE=api://private-app/.default

# -----------------------------------------------------------------------------
# Logging
# -----------------------------------------------------------------------------
LOG_LEVEL=debug
LOG_FORMAT=dev
LOG_PII=true

# -----------------------------------------------------------------------------
# OpenTelemetry (LOG-007)
# Cloud-agnostic telemetry — works with any OTLP-compatible backend
# (Azure Monitor, Datadog, Grafana, Jaeger, etc.)
# -----------------------------------------------------------------------------
OTEL_ENABLED=false
OTEL_SERVICE_NAME=aim-api
# OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4318

# -----------------------------------------------------------------------------
# Feature Flags
# -----------------------------------------------------------------------------
FEATURE_ANALYTICS=true
FEATURE_HEALTH_CHECK=true
